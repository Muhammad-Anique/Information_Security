import React, { useState, useTransition } from 'react'

function CSRF() {

  const [url, setUrl] =useState("https://flexstudent.nu.edu.pk/")
  const [detected, setDetected] =useState('')
  const [name, setName] =useState("https://flexstudent.nu.edu.pk/")
  const [border, setBorder] =useState('border-[#36517c]')
  const handleClickSqli = () => {
    setDetected("Detecting .....")
    setBorder('border-yellow-500')

    // Define the URL
    const apiUrl = 'http://localhost:8080/sqli';

    // Request body containing the URL
    const requestBody = {
      url: url
    };

    // Making the GET request with fetch
    fetch(apiUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(requestBody) // Convert the request body to JSON
    })
      .then(response => {
        // Handle the response
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json(); // Parse the JSON response
      })
      .then(data => {
        console.log('Response:', data);
        setDetected(data.output)
        const substringExists = data.output.includes('--True');
        if (substringExists) {
            setBorder('border-red-500')
            alert("Vulenrablility Detected")
        } else {
            setBorder('border-green-500')
       
        }
      })
      .catch(error => {
        // Handle errors
        console.error('There was a problem with the fetch operation:', error);
      });
  };



  const handleClickXSS = () => {
    // Define the URL
    setDetected("Detecting .....")
    setBorder('border-yellow-500')
    const apiUrl = 'http://localhost:8080/xss';

    // Request body containing the URL
    const requestBody = {
      url: url
    };

    // Making the GET request with fetch
    fetch(apiUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(requestBody) // Convert the request body to JSON
    })
      .then(response => {
        // Handle the response
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json(); // Parse the JSON response
      })
      .then(data => {
        console.log('Response:', data);
        setDetected(data.output)
        const substringExists = data.output.includes('--True');
        if (substringExists) {
            setBorder('border-red-500')
            alert("Vulenrablility Detected")
      
        } else {
            setBorder('border-green-500')
       
        }
      })
      .catch(error => {
        // Handle errors
        console.error('There was a problem with the fetch operation:', error);
      });
  };



  const handleClickCSRF= () => {
    // Define the URL
    setDetected("Detecting .....")
    setBorder('border-yellow-500')
    const apiUrl = 'http://localhost:8080/csrf';

    // Request body containing the URL
    const requestBody = {
      url: url
    };

    // Making the GET request with fetch
    fetch(apiUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(requestBody) // Convert the request body to JSON
    })
      .then(response => {
        // Handle the response
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json(); // Parse the JSON response
      })
      .then(data => {
        console.log('Response:', data);
        setDetected(data.output)
        const substringExists = data.output.includes('--True');
        if (substringExists) {
            setBorder('border-red-500')
            alert("Vulenrablility Detected")
      
        } else {
            setBorder('border-green-500')
       
        }
      })
      .catch(error => {
        // Handle errors
        console.error('There was a problem with the fetch operation:', error);
      });
  };


  return (
    <div className='bg-[#0b254d] bg-opacity-95 py-20  w-screen h-screen  z-20 p-5 shadow-xl overflow-hidden flex flex-row justify-center items-center'>
           
    <div className='flex flex-col justify-center w-[45%] h-full items-center p-2'>
    <h1 className='font-bold text-3xl text-white'>Preview</h1>
     <h1 className='text-gray-200 text-md w-[75%] px-5 py-1 mt-3  border-[#36517c] border-2 bg-black bg-opacity-20'>
    {name}
     </h1>
    <iframe 
      src={name}
      frameborder="0"
      className='w-[75%] h-[65%] object-cover mt-3  shadow-2xl'       
      >
     </iframe>

    </div>
  
  
  
    <div className='flex flex-col justify-center w-[55%] px-10 h-full items-center p-2 '>
        <h1 className='font-bold text-3xl text-white'>Malware Testing</h1>

        <div className='flex flex-row justify-center items-center w-full'>
        <input onChange={(e)=>{setUrl(e.target.value)}} type="text"  value={url} className='text-gray-200 text-md w-[87%] px-5 py-1 mt-3 border-[#36517c] border-2 bg-black bg-opacity-40' placeholder='Enter Url' 
        
        
        />
        <button className='text-gray-200 text-[10px] ml-1 w-[37px] h-[37px] p-2 mt-3 border-[#36517c] border-2 bg-black bg-opacity-40 hover:bg-cyan-600 hover:text-black' onClick={()=>{
            setName(url)
        }}>go </button>

        </div>
       
        
      
        <div className='flex flex-row flex-wrap justify-center items-center'>
            <button onClick={handleClickCSRF} className='text-gray-200 text-md w-[220px] h-[120px] px-4 py-1  mt-3 border-[#36517c] border-2 bg-black bg-opacity-40 hover:border-white hover:scale-110 ease-in-out duration-75' >
            <h1 className='text-white text-2xl font-bold'>
                CSRF
            </h1>
            <p className='text-[9px] mt-1 text-left'>CSRF, or Cross-Site Request Forgery, is a type of cyber attack where unauthorize user exploit the user's active session.  </p>
            </button>
            <button onClick={handleClickSqli} className='text-gray-200 text-md w-[220px] ml-3 h-[120px] px-4 py-1  mt-3 border-[#36517c] border-2 bg-black bg-opacity-40 hover:border-white hover:scale-110 ease-in-out duration-75'  >
            <h1 className='text-white text-2xl font-bold'>
                SQLI
            </h1>
            <p className='text-[9px] mt-1 text-left'>
SQL injection (SQLi) is a cybersecurity vulnerability allowing malicious actors to manipulate or inject SQL code into input fields.  </p>
            </button>
            <button onClick={handleClickXSS} className='text-gray-200 text-md w-[220px] ml-3 h-[120px] px-4 py-1  mt-3 border-[#36517c] border-2 bg-black bg-opacity-40 hover:border-white hover:scale-110 ease-in-out duration-75' >
            <h1 className='text-white text-2xl font-bold'>
               XSS
            </h1>
            <p className='text-[9px] mt-1 text-left'>Cross-Site Scripting (XSS) is a cyber threat where attackers inject malicious scripts into web pages </p>
            </button>
        </div>

        <div className={`text-gray-200  text-md w-[92%] h-[250px] px-5 py-1  mt-3 ${border} border-4 bg-black bg-opacity-40`}>
        {detected}
        </div>
      
      
        

    </div>
    


 </div>
  )
}

export default CSRF
